# 深入浅出 Vite

## 开篇

### 前端工程的意义

**前端工程的痛点问题**：

* 前端的**模块化需求**
* **兼容浏览器，编译高级语法**
* **线上代码的质量问题**
* **开发效率问题**：项目的冷启动/二次启动时间、热更新时间

前端构建工具如何解决上述问题：

* 模块化方面，提供模块加载方案，并兼容不同的模块规范。
* 语法转译方面，配合 `Sass`、`TSC`、`Babel` 等前端工具链，完成高级语法的转译功能，同时对于静态资源也能进行处理，使之能作为一个模块正常加载。
* 产物质量方面，在生产环境中，配合 `Terser` 等压缩工具进行代码压缩和混肴，通过 `Tree Shaking` 删除未使用的代码，提供对于低版本浏览器的语法降级处理等等。
* 开发效率方面，构建工具本身通过各种方式来进行性能优化，包括 `使用原生语言 Go/Rust`、`no-bundle` 等等思路，提高项目的启动性能和热更新的速度。

### Vite 的优越性

1. 在开发效率方面，Vite 的启动性能更快，能够达到毫秒级的瞬间热更新效果。

   > webpack 启动速度慢以及热更新需要等待时间久的原因主要是：
   >
   > * 项目冷启动时必须递归打包整个项目的依赖树
   > * JS 语言本身存在性能限制，导致构建性能遇到瓶颈，直接影响开发效率
   >
   > Vite 的解决方法：
   >
   > * Vite 在开发阶段基于浏览器原生 ESM 的支持实现了 `no-bundle` 服务
   > * 借助 ESbuild 超快的编译速度来做第三方库构建和 TS/JSX 语法编译，从而能够有效提高开发效率

2. 模块化方面，Vite 基于浏览器原生 ESM 的支持实现模块加载，并且无论是开发环境还是生产环境，都可以将其他格式的产物转换为 ESM。

3. 语法转译方面，Vite 内置了对 TypeScript、JSX、Sass 等高级语法的支持，也能够加载各种各样的静态资源，如图片、Worker 等等。

4. 产物质量方面，Vite 基于成熟的打包工具 Rollup 实现生产环境打包，同时可以配合 `Terser`、`Babel` 等工具链，可以极大程度保证构建产物的质量。

## 为什么 ESM 是前端模块化的未来